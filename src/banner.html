<!doctype html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Changebot Banner - Production Example</title>

    <script type="module" src="/build/widgets.esm.js"></script>
    <script nomodule src="/build/widgets.js"></script>

    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 40px;
        padding-top: 80px; /* Space for banner */
        background: #f5f5f5;
        min-height: 100vh;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      h1 {
        margin-top: 0;
        color: #333;
      }

      h2 {
        color: #555;
        margin-top: 30px;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 10px;
      }

      code {
        background: #f4f4f4;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
      }

      pre {
        background: #1e1e1e;
        color: #d4d4d4;
        padding: 20px;
        border-radius: 4px;
        overflow-x: auto;
        font-family: 'Courier New', monospace;
        margin: 20px 0;
      }

      pre code {
        background: none;
        padding: 0;
        color: inherit;
        font-size: 14px;
      }

      button {
        padding: 10px 20px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-right: 10px;
        margin-bottom: 10px;
        font-size: 14px;
      }

      button:hover {
        background: #0056b3;
      }

      button.secondary {
        background: #6c757d;
      }

      button.secondary:hover {
        background: #545b62;
      }

      .controls {
        margin: 20px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 4px;
      }

      .controls h3 {
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 16px;
        color: #333;
      }

      .demo-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .demo-card {
        padding: 15px;
        background: #f9f9f9;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
      }

      .demo-card h4 {
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 14px;
        color: #666;
      }

      .demo-card button {
        width: 100%;
        margin: 0;
      }

      .info-box {
        background: #e7f3ff;
        border: 1px solid #b3d9ff;
        border-radius: 4px;
        padding: 15px;
        margin: 20px 0;
      }

      .info-box p {
        margin: 5px 0;
      }

      .status {
        padding: 12px;
        background: #d4edda;
        border: 1px solid #c3e6cb;
        border-radius: 4px;
        color: #155724;
        margin: 15px 0;
        font-size: 14px;
      }

      a {
        color: #007bff;
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      ul {
        line-height: 1.8;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      th {
        text-align: left;
        padding: 10px;
        background: #f8f9fa;
        border-bottom: 2px solid #dee2e6;
        font-weight: 600;
      }

      td {
        padding: 10px;
        border-bottom: 1px solid #e0e0e0;
      }
    </style>
  </head>
  <body>
    <!-- Provider Component - Fetches updates from Changebot API -->
    <changebot-provider slug="changebot" poll-interval="30"></changebot-provider>

    <!-- Banner Component - Displays at top of page -->
    <changebot-banner id="banner-automatic"></changebot-banner>
    <changebot-banner id="banner-demo" scope="banner-demos"></changebot-banner>

    <div class="container">
      <h1>Changebot Banner - Production Example</h1>
      <p>Banner notifications display updates across the top of the page. Click to expand for full details.</p>

      <div class="info-box">
        <p><strong>Live Demo:</strong> The automatic banner is connected to the real Changebot API and will appear when new updates are available.</p>
        <p><strong>Polling:</strong> Checks for new updates every 30 seconds.</p>
        <p><strong>Auto-Display:</strong> The banner appears automatically when new updates are published that you haven't seen yet.</p>
        <p><strong>Expand/Collapse:</strong> Click the banner to toggle between collapsed (single line) and expanded (full content) views.</p>
      </div>

      <p>Features:</p>
      <ul>
        <li>üéØ Automatically shows the most recent unviewed update</li>
        <li>üìè Collapses to a single line with ellipsis for long content</li>
        <li>üñ±Ô∏è Click to expand/collapse for full details</li>
        <li>üé® Theme support with auto light/dark mode detection</li>
        <li>üíæ Remembers dismissed updates using localStorage</li>
        <li>üîÑ Works seamlessly with the same provider as badge/drawer/toast</li>
        <li>‚å®Ô∏è Keyboard accessible (Enter/Space to toggle, Esc to dismiss)</li>
      </ul>

      <h2>Manual Testing</h2>
      <p>Test different banner themes with mock data:</p>

      <div class="controls">
        <h3>Theme Demos</h3>
        <div class="demo-grid">
          <div class="demo-card">
            <h4>Default Theme</h4>
            <button onclick="showBannerDemo()">Show Banner</button>
          </div>
          <div class="demo-card">
            <h4>Catppuccin Latte</h4>
            <button onclick="showBannerDemo('catppuccin-latte')">Show Banner</button>
          </div>
          <div class="demo-card">
            <h4>Catppuccin Mocha</h4>
            <button onclick="showBannerDemo('catppuccin-mocha')">Show Banner</button>
          </div>
          <div class="demo-card">
            <h4>Gruvbox Dark</h4>
            <button onclick="showBannerDemo('gruvbox-dark')">Show Banner</button>
          </div>
          <div class="demo-card">
            <h4>Dracula</h4>
            <button onclick="showBannerDemo('dracula')">Show Banner</button>
          </div>
          <div class="demo-card">
            <h4>Nord</h4>
            <button onclick="showBannerDemo('nord')">Show Banner</button>
          </div>
          <div class="demo-card">
            <h4>Tokyo Night</h4>
            <button onclick="showBannerDemo('tokyo-night')">Show Banner</button>
          </div>
          <div class="demo-card">
            <h4>Cyberpunk</h4>
            <button onclick="showBannerDemo('cyberpunk')">Show Banner</button>
          </div>
        </div>
      </div>

      <div class="controls">
        <h3>Control Demos</h3>
        <button onclick="toggleBannerExpansion()">Toggle Expansion</button>
        <button class="secondary" onclick="dismissBanner()">Dismiss Banner</button>
        <button class="secondary" onclick="clearBannerHistory()">Clear History</button>
      </div>

      <h2>Usage</h2>

      <h3>Basic Setup</h3>
      <pre><code>&lt;!-- Provider Component --&gt;
&lt;changebot-provider slug="your-slug" poll-interval="30"&gt;&lt;/changebot-provider&gt;

&lt;!-- Banner Component --&gt;
&lt;changebot-banner&gt;&lt;/changebot-banner&gt;</code></pre>

      <h3>With Theme</h3>
      <pre><code>&lt;!-- Fixed theme --&gt;
&lt;changebot-banner theme="catppuccin-mocha"&gt;&lt;/changebot-banner&gt;

&lt;!-- Auto light/dark mode --&gt;
&lt;changebot-banner
  light="catppuccin-latte"
  dark="catppuccin-mocha"&gt;
&lt;/changebot-banner&gt;</code></pre>

      <h3>With Custom Scope</h3>
      <pre><code>&lt;!-- Multiple independent banners --&gt;
&lt;changebot-provider slug="product-updates" scope="product"&gt;&lt;/changebot-provider&gt;
&lt;changebot-banner scope="product"&gt;&lt;/changebot-banner&gt;

&lt;changebot-provider slug="blog-posts" scope="blog"&gt;&lt;/changebot-provider&gt;
&lt;changebot-banner scope="blog"&gt;&lt;/changebot-banner&gt;</code></pre>

      <h2>Props</h2>

      <table>
        <thead>
          <tr>
            <th>Prop</th>
            <th>Type</th>
            <th>Default</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>scope</code></td>
            <td>string</td>
            <td>"default"</td>
            <td>Connect to provider with matching scope</td>
          </tr>
          <tr>
            <td><code>theme</code></td>
            <td>Theme</td>
            <td>-</td>
            <td>Fixed color theme</td>
          </tr>
          <tr>
            <td><code>light</code></td>
            <td>Theme</td>
            <td>-</td>
            <td>Theme for light mode (auto-switches)</td>
          </tr>
          <tr>
            <td><code>dark</code></td>
            <td>Theme</td>
            <td>-</td>
            <td>Theme for dark mode (auto-switches)</td>
          </tr>
        </tbody>
      </table>

      <h2>Methods</h2>

      <table>
        <thead>
          <tr>
            <th>Method</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>show(update)</code></td>
            <td>Manually show the banner with a specific update</td>
          </tr>
          <tr>
            <td><code>dismiss()</code></td>
            <td>Dismiss the banner and mark the update as viewed</td>
          </tr>
          <tr>
            <td><code>toggle()</code></td>
            <td>Toggle the expanded/collapsed state</td>
          </tr>
        </tbody>
      </table>

      <h2>Available Themes</h2>
      <ul>
        <li>Catppuccin: <code>catppuccin-latte</code>, <code>catppuccin-frappe</code>, <code>catppuccin-macchiato</code>, <code>catppuccin-mocha</code></li>
        <li>Gruvbox: <code>gruvbox-light</code>, <code>gruvbox-dark</code></li>
        <li>Dracula: <code>dracula</code></li>
        <li>Nord: <code>nord</code></li>
        <li>Solarized: <code>solarized-light</code>, <code>solarized-dark</code></li>
        <li>Everforest: <code>everforest-light</code>, <code>everforest-dark</code></li>
        <li>Tokyo Night: <code>tokyo-night</code></li>
        <li>Cyberpunk: <code>cyberpunk</code></li>
      </ul>

      <div class="status">
        ‚úÖ Connected to Changebot API. The banner will automatically appear when new updates are published.
      </div>
    </div>

    <script>
      // Get banner element
      const banner = document.getElementById('banner-demo');

      // Mock update data
      const mockUpdate = {
        id: 'demo-' + Date.now(),
        title: 'New Feature Released',
        description: '<p>We\'ve just released an exciting new feature that will improve your workflow. This banner shows a single line of content when collapsed, but you can click it to expand and read the full details. Try clicking this banner to see it expand!</p><p>The banner automatically tracks which updates you\'ve seen using localStorage, so you won\'t see the same update twice unless you clear the history.</p>',
        date: new Date().toISOString(),
        timestamp: Date.now()
      };

      // Show banner with theme
      async function showBannerDemo(theme) {
        if (theme) {
          banner.setAttribute('theme', theme);
        } else {
          banner.removeAttribute('theme');
        }

        // Use unique ID for each demo
        const demoUpdate = {
          ...mockUpdate,
          id: 'demo-' + Date.now(),
          title: theme ? `${theme} Theme Demo` : 'Default Theme Demo'
        };

        await banner.show(demoUpdate);
      }

      // Toggle expansion
      async function toggleBannerExpansion() {
        await banner.toggle();
      }

      // Dismiss banner
      async function dismissBanner() {
        await banner.dismiss();
      }

      // Clear localStorage history
      function clearBannerHistory() {
        localStorage.removeItem('changebot:lastViewed:banner-demos');
        localStorage.removeItem('changebot:lastViewed:default');
        alert('Banner history cleared! Refresh the page to see automatic updates again.');
      }
    </script>
  </body>
</html>
